<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Elephant Build Animation</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.js"></script>
  <style>body{margin:0; background:#222;} canvas{display:block; margin:0 auto;}</style>
</head>
<body>
<script>
let img;
let pixelsToDraw = [];
let step = 3000; // pixels per frame
let imgLoaded = false;

function preload() {
  // ⚠️ Use a same-origin image (local file or CORS-enabled URL)
  img = loadImage('elephant.png', ()=>{ imgLoaded = true; });
}

function setup() {
  if(!imgLoaded){
    createCanvas(400,400);
    background(0);
    textSize(20);
    fill(255);
    textAlign(CENTER,CENTER);
    text("Image not loaded", width/2, height/2);
    noLoop();
    return;
  }

  createCanvas(img.width, img.height);
  img.loadPixels();

  for(let x=0; x<img.width; x++){
    for(let y=0; y<img.height; y++){
      let c = img.get(x,y);
      if(alpha(c) > 0) pixelsToDraw.push({x:x, y:y, color:c});
    }
  }
  background(34);
  frameRate(60);
}

function draw() {
  for(let i=0; i<step && pixelsToDraw.length>0; i++){
    let idx = floor(random(pixelsToDraw.length));
    let p = pixelsToDraw.splice(idx,1)[0];
    stroke(p.color);
    point(p.x,p.y);
  }
  if(pixelsToDraw.length == 0){
    noLoop();
  }
}
</script>
</body>
</html>
